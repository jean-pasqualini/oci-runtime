Parfait ğŸ‘ je vais te rÃ©diger une fiche claire pour tes notes.

â¸»

ğŸ“Œ strace

Quâ€™est-ce que câ€™est ?

strace est un outil de diagnostic et de dÃ©bogage Linux qui permet dâ€™observer en temps rÃ©el les appels systÃ¨me (syscalls) quâ€™un processus exÃ©cute et les signaux quâ€™il reÃ§oit.

â¸»

ğŸ”¹ Rappel : syscalls
â€¢	Un appel systÃ¨me est lâ€™interface entre un programme utilisateur et le noyau Linux (exemple : ouvrir un fichier, allouer de la mÃ©moire, crÃ©er un thread, envoyer un paquet rÃ©seau).
â€¢	Exemples : read, write, openat, mmap, clone, socket, futex.

â¸»

ğŸ”¹ Ce que strace permet
1.	Tracer un programme : voir tous les syscalls quâ€™il fait.

strace ls

â†’ affiche tous les appels noyau utilisÃ©s par ls.

	2.	Compter et rÃ©sumer (trÃ¨s utile pour profiler) :

strace -c ./mon_programme

â†’ rÃ©sumÃ© des syscalls avec leur nombre dâ€™appels et temps passÃ©.

	3.	Tracer les appels des sous-processus :

strace -f ./serveur

â†’ suit les fork/clone.

	4.	Filtrer certains syscalls seulement :

strace -e openat,read,write ./mon_programme

â†’ montre uniquement les ouvertures de fichiers et I/O.

	5.	Sauvegarder la trace dans un fichier :

strace -ff -o /tmp/trace ./mon_programme

â†’ crÃ©e /tmp/trace.<pid> pour chaque processus suivi.

â¸»

ğŸ”¹ Cas dâ€™usage concrets
â€¢	DÃ©boguer une appli qui Ã©choue avec Permission denied â†’ voir quel fichier est ouvert.
â€¢	Observer quels fichiers, bibliothÃ¨ques ou sockets un programme utilise.
â€¢	Comprendre les dÃ©pendances dâ€™un binaire statique/dynamique.
â€¢	Construire un profil seccomp en listant tous les syscalls utilisÃ©s.
â€¢	Diagnostiquer des lenteurs (ex. trop de futex ou epoll_wait).

â¸»

ğŸ”¹ Limites
â€¢	Overhead : ralentit un programme car chaque syscall est interceptÃ© via ptrace.
â€¢	Ne montre pas les appels internes aux bibliothÃ¨ques (ex. appels entre fonctions Go ou C), seulement ce qui traverse vers le noyau.
â€¢	NÃ©cessite souvent la capacitÃ© SYS_PTRACE ou dâ€™Ãªtre root.

â¸»

ğŸ”¹ Alternative modernes
â€¢	bpftrace / eBPF : plus lÃ©ger, peut tracer au niveau noyau sans ralentir autant.
â€¢	perf trace : semblable Ã  strace, mais basÃ© sur perf.

â¸»

âœ… En rÃ©sumÃ© :
strace est un stÃ©thoscope du noyau : il Ã©coute tout ce que ton programme demande au systÃ¨me dâ€™exploitation (fichiers, mÃ©moire, processus, rÃ©seau). Câ€™est lâ€™outil de base pour comprendre ce quâ€™un binaire fait â€œsous le capotâ€.

â¸»

Veux-tu que je tâ€™ajoute une table de correspondance entre syscalls courants et leur usage (ex: openat â†’ ouverture fichier, futex â†’ synchro threads) pour complÃ©ter tes notes ?


----
alternative:
auditctl and ausearch
bpftrace
seccomp-tools
SCMP_ACT_LOG
